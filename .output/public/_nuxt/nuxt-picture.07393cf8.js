import{u as x,a as k,b as y,g as w}from"./_base.ad776ce7.js";import{f as j,g as n,u as E,r as I,h as P,i as m,j as h}from"./entry.81283b89.js";const H={...y,legacyFormat:{type:String,default:null},imgAttrs:{type:Object,default:null}},B=j({name:"NuxtPicture",props:H,emits:["load"],setup:(t,u)=>{var f,p,d;const v=x(),o=k(t),z=n(()=>["png","webp","gif"].includes(l.value)),l=n(()=>w(t.src)),a=n(()=>t.format||(l.value==="svg"?"svg":"webp")),g=n(()=>t.legacyFormat?t.legacyFormat:{webp:z.value?"png":"jpeg",svg:"png"}[a.value]||l.value),s=n(()=>a.value==="svg"?[{src:t.src}]:(g.value!==a.value?[g.value,a.value]:[a.value]).map(i=>{const{srcset:A,sizes:F,src:_}=v.getSizes(t.src,{...o.options.value,sizes:t.sizes||v.options.screens,modifiers:{...o.modifiers.value,format:i}});return{src:_,type:`image/${i}`,sizes:F,srcset:A}}));if(t.preload){const e=(f=s.value)!=null&&f[1]?1:0,i={rel:"preload",as:"image",imagesrcset:s.value[e].srcset};(d=(p=s.value)==null?void 0:p[e])!=null&&d.sizes&&(i.imagesizes=s.value[e].sizes),E({link:[i]})}const c={...t.imgAttrs,"data-nuxt-pic":""};for(const e in u.attrs)e in y&&!(e in c)&&(c[e]=u.attrs[e]);const r=I(),b=h().isHydrating;return P(()=>{r.value&&(r.value.complete&&b&&!r.value.getAttribute("data-error")&&u.emit("load",new Event("load")),r.value.onload=e=>{u.emit("load",e)})}),()=>{var e;return m("picture",{key:s.value[0].src},[...(e=s.value)!=null&&e[1]?[m("source",{type:s.value[1].type,sizes:s.value[1].sizes,srcset:s.value[1].srcset})]:[],m("img",{ref:r,...o.attrs.value,...c,src:s.value[0].src,sizes:s.value[0].sizes,srcset:s.value[0].srcset})])}}});export{B as _};
